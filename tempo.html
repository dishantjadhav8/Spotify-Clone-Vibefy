<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title> Vibefy - Music Streaming Platform </title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
        <link rel="stylesheet" href="styles.css">

    </head>
    <body>
        <!-- Navbar header (left side with logo) -->
        <div class="navbar-header">
            <img src="vibefy_logo.png" class="logo-mini">
        </div>
        
        <!-- Navbar start -->
        <nav class="navbar navbar-expand-lg bg-dark border-bottom border-body" data-bs-theme="dark">
            <div class="container-fluid">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="#"><i class="fa-solid fa-house"></i></a>
                    </li>
                    <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="https://www.apple.com/apple-music/"><i class="fa-solid fa-music"></i></a>
                    </li>
                    <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="https://www.youtube.com/"><i class="fa-brands fa-youtube"></i></a>
                    </li>
                </ul>
				<div class="d-flex align-items-center gap-3">
					<div class="spotify-search-bar">
						<i class="fa-solid fa-magnifying-glass"></i>
						<input id="navbarSearchInput" type="search" placeholder="What do you want to listen to?" aria-label="Search"/>
					</div>
					<div class="dropdown">
						<button class="login-button dropdown-toggle" type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false" style="text-decoration: none; border: none;">
							<i class="fa-solid fa-user-circle"></i> <span id="displayUsername">User</span>
						</button>
						<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
							<li><a class="dropdown-item" href="#"><i class="fa-solid fa-user"></i> <span id="dropdownUsername">User</span></a></li>
							<li><hr class="dropdown-divider"></li>
							<li><a class="dropdown-item" href="#" id="logoutBtn"><i class="fa-solid fa-right-from-bracket"></i> Logout</a></li>
						</ul>
					</div>
				</div>
                </div>
            </div>
        </nav>
        <!-- Navbar end -->
        
        <div class="parent">
            <div class="menu">
                <div class="container_mm">
                    <div class="row_mm-1 active">
                        <table cellspacing="10px">
                            <tr>
                                <td>
                                    <img src="home.png" class="home">
                                </td>
                                <td>
                                    <a href="tempo.html"><p><b> Home </b></p></a>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="row_mm-2" id="menuSearchBtn">
                        <table cellspacing="10px">
                            <tr>
                                <td>
                                    <img src="search.png" class="search">
                                </td>
                                <td>
                                    <p><b> Search </b></p>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="row_mm-3">
                        <table cellspacing="10px">
                            <tr>
                                <td>
                                    <img src="library.jpg" class="library">
                                </td>
                                <td>
                                    <a href="library.html"><p><b> Library </b></p></a>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <hr></hr>
                <div class="container_sm">
                    <div class="row_sm-1" id="createPlaylistBtn">
                        <table cellspacing="10px">
                            <tr>
                                <td>
                                    <img src="create playlist.jpg" class="playlist">
                                </td>
                                <td>
                                    <p><b> Create Playlist </b></p>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <hr></hr>
                <div class="scroll-container">
                    <p class="playlist-title">Your Playlists</p>
                    <p>Daily Mix 1</p>
                    <p>Chill Vibes</p>
                    <p>Workout Beats</p>
                    <p>Jazz Classics</p>
                    <p>Party Hits</p>
                    <p>Road Trip</p>
                    <p>Study Focus</p>
                    <p>Relax & Unwind</p>
                </div>
            </div>
            <div class="content">
                <div class="main-content">
                    <h2 style="color: white; font-size: 28px; margin: 40px 0 20px 0; font-weight: 700;">Good afternoon</h2>
                    
                    <!-- Quick Access Playlists -->
                    <div class="quick-playlists-grid">
                        <div class="quick-playlist-card">
                            <img src="https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=80&h=80&fit=crop" alt="Liked Songs">
                            <span class="quick-playlist-title">Liked Songs</span>
                        </div>
                        <div class="quick-playlist-card">
                            <img src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=80&h=80&fit=crop" alt="Daily Mix 1">
                            <span class="quick-playlist-title">Daily Mix 1</span>
                        </div>
                        <div class="quick-playlist-card">
                            <img src="https://images.unsplash.com/photo-1459749411175-04bf5292ceea?w=80&h=80&fit=crop" alt="Chill Vibes">
                            <span class="quick-playlist-title">Chill Vibes</span>
                        </div>
                        <div class="quick-playlist-card">
                            <img src="https://images.unsplash.com/photo-1514320291840-2e0a9bf2a9ae?w=80&h=80&fit=crop" alt="Workout Beats">
                            <span class="quick-playlist-title">Workout Beats</span>
                        </div>
                        <div class="quick-playlist-card">
                            <img src="https://images.unsplash.com/photo-1498038432885-c6f3f1b912ee?w=80&h=80&fit=crop" alt="Rock Classics">
                            <span class="quick-playlist-title">Rock Classics</span>
                        </div>
                        <div class="quick-playlist-card">
                            <img src="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?w=80&h=80&fit=crop" alt="Country Roads">
                            <span class="quick-playlist-title">Country Roads</span>
                        </div>
                    </div>

                    <!-- Queue Section -->
                    <div class="queue-section">
                        <h2>Trending Songs</h2>
                        <div class="queue-list">
                            <div class="queue-item">
                                <img src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=60&h=60&fit=crop" alt="Track">
                                <div class="queue-item-info">
                                    <p class="queue-track-name">Midnight Drive</p>
                                    <p class="queue-artist-name">Neon Dreams</p>
                                </div>
                                <span class="queue-duration">4:12</span>
                                <button class="queue-more-btn"><i class="fa-solid fa-ellipsis"></i></button>
                            </div>
                            <div class="queue-item">
                                <img src="https://images.unsplash.com/photo-1459749411175-04bf5292ceea?w=60&h=60&fit=crop" alt="Track">
                                <div class="queue-item-info">
                                    <p class="queue-track-name">Ocean Waves</p>
                                    <p class="queue-artist-name">Chill Collective</p>
                                </div>
                                <span class="queue-duration">3:28</span>
                                <button class="queue-more-btn"><i class="fa-solid fa-ellipsis"></i></button>
                            </div>
                            <div class="queue-item">
                                <img src="https://images.unsplash.com/photo-1514320291840-2e0a9bf2a9ae?w=60&h=60&fit=crop" alt="Track">
                                <div class="queue-item-info">
                                    <p class="queue-track-name">City Lights</p>
                                    <p class="queue-artist-name">Urban Pulse</p>
                                </div>
                                <span class="queue-duration">3:55</span>
                                <button class="queue-more-btn"><i class="fa-solid fa-ellipsis"></i></button>
                            </div>
                            <div class="queue-item">
                                <img src="https://images.unsplash.com/photo-1498038432885-c6f3f1b912ee?w=60&h=60&fit=crop" alt="Track">
                                <div class="queue-item-info">
                                    <p class="queue-track-name">Electric Storm</p>
                                    <p class="queue-artist-name">Thunder Beats</p>
                                </div>
                                <span class="queue-duration">4:45</span>
                                <button class="queue-more-btn"><i class="fa-solid fa-ellipsis"></i></button>
                            </div>
                            <div class="queue-item">
                                <img src="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?w=60&h=60&fit=crop" alt="Track">
                                <div class="queue-item-info">
                                    <p class="queue-track-name">Country Roads</p>
                                    <p class="queue-artist-name">Acoustic Roots</p>
                                </div>
                                <span class="queue-duration">3:33</span>
                                <button class="queue-more-btn"><i class="fa-solid fa-ellipsis"></i></button>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
        
        <!-- Hidden Audio Player -->
        <audio id="audioPlayer"></audio>
        
        <!-- Spotify-Style Music Player -->
        <div class="spotify-player">
            <div class="player-left">
                <img src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=56&h=56&fit=crop" alt="Now Playing" class="player-album-art">
                <div class="player-track-info">
                    <div class="player-track-name">Midnight Drive</div>
                    <div class="player-artist-name">Neon Dreams</div>
                </div>
                <button class="player-like-btn"><i class="fa-regular fa-heart"></i></button>
            </div>
            
            <div class="player-center">
                <div class="player-controls">
                    <button class="player-control-btn"><i class="fa-solid fa-shuffle"></i></button>
                    <button class="player-control-btn"><i class="fa-solid fa-backward-step"></i></button>
                    <button class="player-control-btn player-play-btn"><i class="fa-solid fa-play"></i></button>
                    <button class="player-control-btn"><i class="fa-solid fa-forward-step"></i></button>
                    <button class="player-control-btn"><i class="fa-solid fa-repeat"></i></button>
                </div>
                <div class="player-progress-container">
                    <span class="player-time-current">0:00</span>
                    <div class="player-progress-bar">
                        <div class="player-progress-fill"></div>
                    </div>
                    <span class="player-time-total">3:45</span>
                </div>
            </div>
            
            <div class="player-right">
                <button class="player-control-btn"><i class="fa-solid fa-list"></i></button>
                <button class="player-control-btn"><i class="fa-solid fa-computer"></i></button>
                <div class="player-volume-container">
                    <button class="player-control-btn"><i class="fa-solid fa-volume-high"></i></button>
                    <div class="player-volume-bar">
                        <div class="player-volume-fill"></div>
                    </div>
                </div>
                <button class="player-control-btn"><i class="fa-solid fa-maximize"></i></button>
            </div>
        </div>
        
        <!-- Create Playlist Modal -->
        <div class="modal-overlay" id="playlistModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Create Playlist</h2>
                    <p>Give your playlist a name and description</p>
                </div>
                <div class="modal-body">
                    <form id="createPlaylistForm">
                        <div class="form-group">
                            <label for="playlistName">Playlist Name</label>
                            <input type="text" id="playlistName" placeholder="My Awesome Playlist" required>
                        </div>
                        <div class="form-group">
                            <label for="playlistDescription">Description (Optional)</label>
                            <textarea id="playlistDescription" placeholder="Add a description for your playlist"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="modal-btn modal-btn-cancel" id="cancelBtn">Cancel</button>
                    <button class="modal-btn modal-btn-create" id="submitBtn">Create</button>
                </div>
            </div>
        </div>
        
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
		<script>
			// Check if user is logged in
			document.addEventListener('DOMContentLoaded', function() {
				const isLoggedIn = sessionStorage.getItem('userLoggedIn');
				const userName = sessionStorage.getItem('userName');
				
				// If not logged in, redirect to login page
				// if (!isLoggedIn) {
				// 	window.location.href = 'vibefy_login.html';
				// 	return;
				// }
				
				// Set username in dropdown
				if (userName) {
					document.getElementById('displayUsername').textContent = userName;
					document.getElementById('dropdownUsername').textContent = userName;
				}
				
				const menuSearchBtn = document.getElementById('menuSearchBtn');
				const navbarSearchInput = document.getElementById('navbarSearchInput');
				
				if (menuSearchBtn && navbarSearchInput) {
					menuSearchBtn.addEventListener('click', function() {
						navbarSearchInput.focus();
					});
				}
				
				// Logout functionality
				const logoutBtn = document.getElementById('logoutBtn');
				logoutBtn.addEventListener('click', function(e) {
					e.preventDefault();
					sessionStorage.removeItem('userLoggedIn');
					sessionStorage.removeItem('userName');
					window.location.href = 'vibefy_login.html';
				});
				
				// Create Playlist Modal functionality
				const createPlaylistBtn = document.getElementById('createPlaylistBtn');
				const playlistModal = document.getElementById('playlistModal');
				const cancelBtn = document.getElementById('cancelBtn');
				const submitBtn = document.getElementById('submitBtn');
				const playlistNameInput = document.getElementById('playlistName');
				const playlistDescriptionInput = document.getElementById('playlistDescription');
				
				// Open modal
				createPlaylistBtn.addEventListener('click', function() {
					playlistModal.classList.add('active');
					playlistNameInput.focus();
				});
				
				// Close modal on cancel
				cancelBtn.addEventListener('click', function() {
					playlistModal.classList.remove('active');
					playlistNameInput.value = '';
					playlistDescriptionInput.value = '';
				});
				
				// Close modal on clicking outside
				playlistModal.addEventListener('click', function(e) {
					if (e.target === playlistModal) {
						playlistModal.classList.remove('active');
						playlistNameInput.value = '';
						playlistDescriptionInput.value = '';
					}
				});
				
				// Create playlist
				submitBtn.addEventListener('click', function() {
					const playlistName = playlistNameInput.value.trim();
					const playlistDescription = playlistDescriptionInput.value.trim();
					
					if (playlistName) {
						// Add new playlist to the sidebar list
						const scrollContainer = document.querySelector('.scroll-container');
						const newPlaylist = document.createElement('p');
						newPlaylist.textContent = playlistName;
						scrollContainer.appendChild(newPlaylist);
						
						// Close modal and reset form
						playlistModal.classList.remove('active');
						playlistNameInput.value = '';
						playlistDescriptionInput.value = '';
						
						// Show success message (optional)
						console.log('Playlist created:', playlistName, playlistDescription);
					} else {
						playlistNameInput.focus();
					}
				});
				
				// Allow Enter key to submit
				playlistNameInput.addEventListener('keypress', function(e) {
					if (e.key === 'Enter') {
						e.preventDefault();
						submitBtn.click();
					}
				});
				
				// Spotify Music Player Functionality
				const audioPlayer = document.getElementById('audioPlayer');
				const playerPlayBtn = document.querySelector('.player-play-btn');
				const playerProgressFill = document.querySelector('.player-progress-fill');
				const playerProgressBar = document.querySelector('.player-progress-bar');
				const playerCurrentTime = document.querySelector('.player-time-current');
				const playerTotalTime = document.querySelector('.player-time-total');
				const playerLikeBtn = document.querySelector('.player-like-btn');
				const playerVolumeBar = document.querySelector('.player-volume-bar');
				const playerVolumeFill = document.querySelector('.player-volume-fill');
				
				// Format time helper
				function formatTime(seconds) {
					const mins = Math.floor(seconds / 60);
					const secs = Math.floor(seconds % 60);
					return mins + ':' + (secs < 10 ? '0' : '') + secs;
				}
				
				// Play/Pause toggle
				if (playerPlayBtn) {
					playerPlayBtn.addEventListener('click', function() {
						if (audioPlayer.paused) {
							audioPlayer.play();
							playerPlayBtn.innerHTML = '<i class="fa-solid fa-pause"></i>';
							playerProgressFill.classList.add('playing');
						} else {
							audioPlayer.pause();
							playerPlayBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
							playerProgressFill.classList.remove('playing');
						}
					});
				}
				
				// Update progress bar as audio plays
				audioPlayer.addEventListener('timeupdate', function() {
					if (audioPlayer.duration) {
						const progress = (audioPlayer.currentTime / audioPlayer.duration) * 100;
						playerProgressFill.style.width = progress + '%';
						playerCurrentTime.textContent = formatTime(audioPlayer.currentTime);
					}
				});
				
				// Update total time when metadata loads
				audioPlayer.addEventListener('loadedmetadata', function() {
					playerTotalTime.textContent = formatTime(audioPlayer.duration);
				});
				
				// When audio ends
				audioPlayer.addEventListener('ended', function() {
					playerPlayBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
					playerProgressFill.classList.remove('playing');
				});
				
				// Progress bar seeking with drag support
				let isSeekingProgress = false;
				
				if (playerProgressBar) {
					playerProgressBar.addEventListener('mousedown', function(e) {
						isSeekingProgress = true;
						playerProgressBar.classList.add('seeking');
						seekToPosition(e);
					});
					
					document.addEventListener('mousemove', function(e) {
						if (isSeekingProgress) {
							seekToPosition(e);
						}
					});
					
					document.addEventListener('mouseup', function() {
						if (isSeekingProgress) {
							isSeekingProgress = false;
							playerProgressBar.classList.remove('seeking');
						}
					});
					
					function seekToPosition(e) {
						if (audioPlayer.duration) {
							const rect = playerProgressBar.getBoundingClientRect();
							let percent = (e.clientX - rect.left) / rect.width;
							percent = Math.max(0, Math.min(1, percent));
							audioPlayer.currentTime = percent * audioPlayer.duration;
						}
					}
				}
				
				// Like button toggle
				if (playerLikeBtn) {
					playerLikeBtn.addEventListener('click', function() {
						this.classList.toggle('liked');
						if (this.classList.contains('liked')) {
							this.innerHTML = '<i class="fa-solid fa-heart"></i>';
						} else {
							this.innerHTML = '<i class="fa-regular fa-heart"></i>';
						}
					});
				}
				
				// Volume control with drag support
				let isAdjustingVolume = false;
				audioPlayer.volume = 0.7;
				playerVolumeFill.style.width = '70%';
				
				if (playerVolumeBar) {
					playerVolumeBar.addEventListener('mousedown', function(e) {
						isAdjustingVolume = true;
						playerVolumeBar.classList.add('adjusting');
						setVolume(e);
					});
					
					document.addEventListener('mousemove', function(e) {
						if (isAdjustingVolume) {
							setVolume(e);
						}
					});
					
					document.addEventListener('mouseup', function() {
						if (isAdjustingVolume) {
							isAdjustingVolume = false;
							playerVolumeBar.classList.remove('adjusting');
						}
					});
					
					function setVolume(e) {
						const rect = playerVolumeBar.getBoundingClientRect();
						let percent = (e.clientX - rect.left) / rect.width;
						percent = Math.max(0, Math.min(1, percent));
						audioPlayer.volume = percent;
						playerVolumeFill.style.width = (percent * 100) + '%';
					}
				}
				
				// Queue item click - update player
				const queueItems = document.querySelectorAll('.queue-item');
				queueItems.forEach(function(item) {
					item.addEventListener('click', function() {
						// Reset all items
						queueItems.forEach(i => i.style.background = 'rgba(255, 255, 255, 0.03)');
						// Highlight clicked item
						this.style.background = 'rgba(29, 185, 84, 0.2)';
						
						// Update player with clicked track info
						const trackName = this.querySelector('.queue-track-name').textContent;
						const artistName = this.querySelector('.queue-artist-name').textContent;
						const trackImage = this.querySelector('img').src;
						
						document.querySelector('.player-track-name').textContent = trackName;
						document.querySelector('.player-artist-name').textContent = artistName;
						document.querySelector('.player-album-art').src = trackImage;
						
						// If you have audio sources, set them here
						// audioPlayer.src = 'path/to/audio.mp3';
						// audioPlayer.play();
						// playerPlayBtn.innerHTML = '<i class="fa-solid fa-pause"></i>';
						// playerProgressFill.classList.add('playing');
					});
				});
			});
		</script>
    </body>
</html>